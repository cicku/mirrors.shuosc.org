<!DOCTYPE html>
<html>
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
	<meta name="viewport" content="width=device-width,initial-scale=1">
	<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
	<title>上海大学开源社区镜像站</title>
	<link rel="stylesheet" href="css/style.css">
	<link rel="shortcut icon" href="favicon.ico">
</head>
<body>
	<div class="main-panel" style="width:1000px;">
		<img src="logo.png" class="logo">
		<div class="title">上海大学开源社区镜像站</div>
		<div class="mirror-list">
			<div class="list-item">
				<img src="images/ubuntu-icon.png" class="mirror-icon">
				<div class="item-container">
					<div class="mirror-title"> <a href="/ubuntu">Ubuntu</a> </div> 
					<div class="update-status"></div>
				</div>
			</div>
			<div class="list-item">
				<img src="images/centos-icon.png" class="mirror-icon">
				<div class="item-container">
					<div class="mirror-title"> <a href="/centos">CentOS</a> </div> 
					<div class="update-status"></div>
				</div>
			</div>
			<div class="list-item">
				<img src="images/archlinux-icon.png" class="mirror-icon">
				<div class="item-container">
					<div class="mirror-title"> <a href="/archlinux">Arch Linux</a> </div> 
					<div class="update-status"></div>
				</div>
			</div>
			<div class="list-item">
				<img src="images/opensuse-icon.png" class="mirror-icon">
				<div class="item-container">
					<div class="mirror-title"> <a href="/opensuse">OpenSUSE</a> </div> 
					<div class="update-status"></div>
				</div>
			</div>
            <div class="list-item">
                <img src="images/postgresql.png" class="mirror-icon">
                <div class="item-container">
                    <div class="mirror-title"> <a href="/postgresql">Postgresql</a> </div>
                    <div class="update-status"></div>
                </div>
            </div>
            <div class="list-item">
                <img src="/images/Rlogo.svg" class="mirror-icon">
                <div class="item-container">
                    <div class="mirror-title"> <a href="/cran">Cran</a></div>
                    <div class="update-status"></div>
                </div>
            </div>
		</div>
		<div class="footer">
			<a href="mailto:bucketzxm@gmail.com" class="contact">联系我们</a>&nbsp;&nbsp;&nbsp;&nbsp;
            <a href="/" class="contact">首页</a>
		</div>
	</div>

	<script src="js/trianglify.min.js"></script>
    <script src="src/es6-promise/es6-promise.min.js"></script>
    <script src="src/fetch/fetch.js"></script>
	<script>
		var background = Trianglify({
			y_colors: ["#2b7c6b", "#56c6af","#44967f","#22bc9e"],
			x_colors: ["#34485e", "#435c70"],
			cell_size: 150,
			width: window.screen.width,
			height: window.screen.height
    	});
    	document.body.style['background'] = 'url(' + background.png() + ')';
        /** 更新时间*/
        var time = document.getElementsByClassName("list-item");
        function insertData(num ,json ,type ){
            var string = '在';
            string+=json[type].date;
            string+='同步完成：';
            string+=json[type].message;
            string+='，下次同步时间';
            string+=json[type].schedule;
            time[num].querySelector(".update-status").innerHTML = string
        }
        fetch('status/task_status.json')
            .then(function(response) {
                return response.json()
            }).then(function(json) {
                insertData(0,json,'ubuntu');
                insertData(1,json,'centos');
                insertData(2,json,'archlinux');
                insertData(3,json,'opensuse');
                insertData(4,json,'postgresql');
                insertData(5,json,'cran');
            }).catch(function(ex) {
                console.log('parsing failed', ex)
            })
	</script>
</body>
</html>
